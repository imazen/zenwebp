[package]
name = "zenwebp"
version = "0.1.0"
edition = "2021"
license = "MIT OR Apache-2.0"
rust-version = "1.88"

description = "High-performance WebP encoding and decoding in pure Rust"
homepage = "https://github.com/imazen/zenwebp"
repository = "https://github.com/imazen/zenwebp"
categories = ["multimedia::images", "multimedia::encoding", "encoding"]

include = ["/src", "LICENSE-APACHE", "LICENSE-MIT", "README.md"]

[dependencies]
# Core dependencies - all no_std compatible
byteorder-lite = { version = "0.1.0", default-features = false }
hashbrown = { version = "0.15", default-features = false, features = ["default-hasher"] }
libm = "0.2"
thiserror = { version = "2.0.18", default-features = false }
whereat = { version = "0.1.3", default-features = false }
yuv = { version = "0.8", optional = true }
png = { version = "0.17.12", optional = true }
webp = { version = "0.3.0", optional = true }
multiversed = { version = "0.1.0", optional = true }
multiversion = { version = "0.8.0", optional = true }
archmage = { path = "../archmage", optional = true }
safe_unaligned_simd = { version = "0.2", optional = true }

[dev-dependencies]
yuv = "0.8"
dssim-core = "3.3"
fast-ssim2 = "0.6"
imgref = "1.10"
paste = "1.0.14"
png = "0.17.12"
rand = "0.8.5"
rgb = "0.8"
webp = "0.3.0"

[features]
default = ["std", "fast-yuv", "simd"]
# Enable std library. Required only for Encoder.encode_to_writer().
# Without std, use slice-based decoder and Vec-based encoder APIs.
std = ["thiserror/std", "whereat/std", "byteorder-lite/std"]
fast-yuv = ["dep:yuv"]
# Enable SIMD intrinsics via archmage (safe API with token-based feature verification).
# Provides best performance on x86-64 with runtime CPU detection.
simd = ["dep:multiversed", "dep:multiversion", "dep:archmage", "dep:safe_unaligned_simd"]
_benchmarks = []
_profiling = ["dep:png", "dep:webp"]

[[bin]]
name = "profile_encode"
path = "benches/profile_encode.rs"
required-features = ["_profiling"]

[[bin]]
name = "profile_libwebp"
path = "benches/profile_libwebp.rs"
required-features = ["_profiling"]

[[bin]]
name = "profile_decode"
path = "benches/profile_decode.rs"
required-features = ["_profiling"]
